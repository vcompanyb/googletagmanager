let SEND_SCROLLED_ONLY_FIRST_TIME=!0,products={},STEP_CARRITO=1,DATALAYER=!1,idErrorsCheckout=["error-for-email","error-for-last_name","error-for-address1","error-for-city","error-for-province","error-for-zip","error-for-phone"],idErrorsPayment=["error-for-number","error-for-name","error-for-expiry","error-for-verification_value"],classBindActions=["gtm-product","gtm-action","gtm-add-to-cart-product","gtm-checkout-button","gtm-modify-cart-product","gtm-remove-from-cart"],didScroll=!1,scrolledCategories=[],scrolledProducts=[],lastProductScrolled=[],ACCEPTED_GDPR=!1;const CHECKOUT_STEP_1="contact_information",CHECKOUT_STEP_2="shipping_method",CHECKOUT_STEP_3="payment_method",DEBUG=setDEBUG();function setDEBUG(){let debug_active=!1,gtm_debug_url_parameter=getUrlParameter("gtm_debug");if(null!==(gtm_debug_url_parameter=!!+gtm_debug_url_parameter))debug_active=gtm_debug_url_parameter;else if("undefined"!=typeof Storage){let gtm_debug_local_storage=localStorage.getItem("gtm_debug");gtm_debug_local_storage&&(debug_active=gtm_debug_local_storage)}return"undefined"!=typeof Storage&&(debug_active?localStorage.setItem("gtm_debug",debug_active):localStorage.removeItem("gtm_debug")),debug_active}function setDataLayer(googleConfig,acceptedGDPR=!1){if(ACCEPTED_GDPR=acceptedGDPR,IS_GTM_ACTIVE){writeDebug("setDataLayer");let ecomm_totalvalue,freeShipping=void 0;isCheckoutPage()&&("thank_you"===Shopify.Checkout.step?(googleConfig.page_type="purchase",googleConfig.ecomm_pagetype="purchase",freeShipping=getFreeShipping(gtm_shipping_price)):(googleConfig.page_type+=" "+getNumStepCheckout(),"payment_method"===Shopify.Checkout.step&&(freeShipping=getFreeShipping(gtm_shipping_price)))),ecomm_totalvalue="Product"===googleConfig.page_type?googleConfig.product_price:googleConfig.cart_value;let keyCartValue="cart_value_"+googleConfig.currency_code,user_browser_lang=window.navigator.userLanguage||window.navigator.language,dataLayer={cart_quantity:parseFloat(googleConfig.cart_quantity),[keyCartValue]:parseFloat(googleConfig.cart_value),client_id:getClientID(),currency_code:googleConfig.currency_code,device:getDeviceFromWindow(),ecomm_pagetype:googleConfig.ecomm_pagetype,ecomm_prodid:googleConfig.ecomm_prodid,ecomm_totalvalue:parseFloat(ecomm_totalvalue),page_name:googleConfig.page_name,page_type:googleConfig.page_type,user_browser_lang:user_browser_lang.substring(0,2),user_id:getUserID(),user_type:getUserType()};return"EUR"!==googleConfig.currency_code&&(dataLayer.cart_value_EUR=convertToEur(googleConfig.cart_value,googleConfig.currency_code)),"index"!==googleConfig.page_type&&"product"!==googleConfig.page_type&&"collection"!==googleConfig.page_type||(dataLayer.coupon_code=getInitialCoupon()),googleConfig.payment_method&&(dataLayer.payment_method=googleConfig.payment_method),void 0!==freeShipping&&(dataLayer.shipping_free=freeShipping),void 0!==googleConfig.ecomm_category&&(dataLayer.ecomm_category=googleConfig.ecomm_category),writeDebug(dataLayer),DATALAYER=!0,sendDataToAudit(dataLayer),[dataLayer]}return[]}function getNumStepCheckout(){return Shopify.Checkout.step===CHECKOUT_STEP_1?1:Shopify.Checkout.step===CHECKOUT_STEP_2?2:Shopify.Checkout.step===CHECKOUT_STEP_3?3:void 0}function tryProcessGTM(){setTimeout(function(){DATALAYER?processGTM():tryProcessGTM()},50)}function processGTM(){writeDebug("DataLayer"),writeDebug(dataLayer);for(let i=0;i<classBindActions.length;i++){let clase=classBindActions[i],elements=document.getElementsByClassName(clase);for(let j=0;j<elements.length;j++)elements[j].addEventListener("click",actionEvent)}isCheckoutPage()?processCheckout():processNotInCheckout(),sendCountryUser()}function isCheckoutPage(){return-1!==location.href.indexOf("/checkouts/")}function processCheckout(){writeDebug("Estamos en el checkout"),bindObserverCoupon();let actualStep=Shopify.Checkout.step;if("contact_information"===actualStep){if(checkout(2),addDataToPaypalButton(),checkErrorsInCheckout("continuar_KO_datos_usuario"),ACCEPTED_GDPR){let buttonsContinue=document.getElementsByClassName("step__footer__continue-btn");for(let j=0;j<buttonsContinue.length;j++)buttonsContinue[j].addEventListener("click",saveCustomerInformation)}}else"shipping_method"===actualStep?(checkout(3),customerStepOK()):"payment_method"===actualStep?(checkout(4),checkErrorsInCheckout("continuar_KO_direccion_pago"),checkErrorsInCheckout("continuar_KO_tarjeta_pago"),bindBtnContinuePaymentMethod()):"thank_you"===actualStep&&(OKPago(),thanksPage());bindBackButtonInCheckout(),bindBreadcrumbClick()}function processNotInCheckout(){window.onscroll=function(){didScroll=!0},setTimeout(scrollWasMade,50),getProductsImpressions(),detectFirstRowCategory(),bindSocialButtons();let inputsUpdates=document.getElementsByName("updates[]");for(let j=0;j<inputsUpdates.length;j++)inputsUpdates[j].addEventListener("change",cartModified);sendPromotion()}function scrollWasMade(){didScroll&&(didScroll=!1,detectFirstRowCategory(),getProductsImpressions()),setTimeout(scrollWasMade,50)}function sendPromotion(){let promotion=getPromotion();writeDebug("sendPromotion"),sendObject({promotion:promotion}),localStorage.setItem("promotionHome",promotion)}function getPromotion(){let alt,bannersIndex=document.getElementsByClassName("banner-index");for(let j=0;j<bannersIndex.length;j++){let imgs=bannersIndex[j].getElementsByTagName("img");for(let i=0;i<imgs.length;i++)alt=getData(imgs[i],"type-promo")}if(void 0!==alt&&null!==alt)return alt;{let promotionHome=localStorage.getItem("promotionHome");return null!==promotionHome&&"null"!==promotionHome?promotionHome:"undefined"}}function writeDebug(msg){DEBUG&&console.log(msg)}function sendEvent(event,action,label){writeDebug("sendEvent"),sendObject(getStandardObject(event,action,label))}function sendDataToAudit(object){if("undefined"!=typeof Storage){let token=getUrlParameter("audit_gtm");if(null!=token&&sessionStorage.setItem("audit_gtm",token),null!==(token=sessionStorage.getItem("audit_gtm"))){let phase=GTM_PHASE_2?1:0,url="https://cdn.vulturdev.com/api/petition";url+="?data="+JSON.stringify(object),url+="&GTM_PHASE_2="+phase,url+="&token="+token,url+="&GTM_ID="+GTM_ID,url+="&domain="+document.domain,getJSONP(url+="&callback=?",responseAudit)}}}function getJSONP(url,success){let ud="_"+ +new Date+"_"+Math.floor(1e3*Math.random()+1),script=document.createElement("script"),head=document.getElementsByTagName("head")[0]||document.documentElement;window[ud]=function(data){head.removeChild(script),success&&success(data)},script.src=url.replace("callback=?","callback="+ud),head.appendChild(script)}function responseAudit(json){if("OK"===json.status){writeDebug("JSON manager: "),writeDebug(json);let url_auditoria="https://cdn.vulturdev.com/audits/"+json.audit_id;if(null===document.getElementById("gtm-modal-audit")){let body=document.getElementsByTagName("body")[0];void 0!==body&&(body.insertAdjacentHTML("afterbegin",'<div id="gtm-modal-audit" style="position: fixed; bottom: 5em; right: 1em;z-index: 999999; background-color: #007bff; padding: 1em; border-radius: 3px; box-shadow: 0 2px 2px 0 rgba(0,0,0,0.14), 0 3px 1px -2px rgba(0,0,0,0.12), 0 1px 5px 0 rgba(0,0,0,0.2);"><a href="'+url_auditoria+'" target="_blank" style="color: #fff;" >Ir a auditor√≠a GTM</a></div>'),setTimeout(function(){document.getElementById("gtm-modal-audit").style.top="auto"},3e3))}}else if(null===document.getElementById("gtm-modal-audit")){document.getElementsByTagName("body")[0].insertAdjacentHTML("afterbegin",'<div id="gtm-modal-audit" style="position: fixed; bottom: 5em; right: 1em;z-index: 999999; background-color: #007bff; padding: 1em; border-radius: 3px; box-shadow: 0 2px 2px 0 rgba(0,0,0,0.14), 0 3px 1px -2px rgba(0,0,0,0.12), 0 1px 5px 0 rgba(0,0,0,0.2);"><span>Token not recognized</span></div>'),setTimeout(function(){document.getElementById("gtm-modal-audit").style.top="auto"},3e3)}}function getUrlParameter(name){return decodeURIComponent((new RegExp("[?|&]"+name+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function getStandardObject(event,action,label){return{event:event,eAction:action,eLabel:label}}function sendObject(object){writeDebug("GTM"),writeDebug(object),sendDataToAudit(object),dataLayer.push(object)}function addDataToPaypalButton(){let paypalExpressCheckoutBtn=document.getElementById("paypal-express-checkout-btn");null!==paypalExpressCheckoutBtn&&(setData(paypalExpressCheckoutBtn,"gtm-event","formulario"),setData(paypalExpressCheckoutBtn,"gtm-action","datos_con_paypal"),setData(paypalExpressCheckoutBtn,"gtm-label","datos_con_paypal"),paypalExpressCheckoutBtn.addEventListener("click",actionEvent))}function bindBreadcrumbClick(){let actualPositionBreadcrumb=getActualPositionBreadCrumb(),breadcrumb=document.getElementsByClassName("breadcrumb");for(let j=0;j<breadcrumb.length;j++){let enlaces=breadcrumb[j].getElementsByTagName("a");for(let i=0;i<enlaces.length;i++){let href=enlaces[i].href;getPositionBreadcrumbClicked(href)<actualPositionBreadcrumb&&(href.indexOf("/cart")>=0?bindDataToElement("interaccion","volver_carrito","volver",this):href.indexOf("contact_information")>=0?bindDataToElement("interaccion","volver_info_cliente","volver",this):href.indexOf("shipping_method")>=0&&bindDataToElement("interaccion","volver_forma_envio","volver",this))}}}function bindObserverCoupon(){let buttonApply=getButtonApplyCoupon(getCouponInput());null!==buttonApply&&buttonApply.addEventListener("click",function(){let interval=setInterval(function(){let couponInput=getCouponInput();if(null!==couponInput&&!(buttonApply=getButtonApplyCoupon(couponInput)).classList.contains("btn--loading")){writeDebug("Ya hemos recibido respuesta");let errorForCoupon=document.getElementById("error-for-reduction_code");if(errorForCoupon.length>0&&"visible"===errorForCoupon.style.display){writeDebug("Hay error y es visible"),cuponInvalid(couponInput.value)}clearInterval(interval),bindObserverCoupon()}},500)})}function getCouponInput(){return document.getElementById("checkout_reduction_code")}function getButtonApplyCoupon(couponInput){return null!==couponInput?couponInput.parentElement.parentElement.getElementsByTagName("button")[0]:null}function getActualPositionBreadCrumb(){let breadcrumb=document.getElementsByClassName("breadcrumb");for(let j=0;j<breadcrumb.length;j++){let lis=breadcrumb[j].getElementsByTagName("li");for(let i=0;i<lis.length;i++)if(lis[i].classList.contains("item--current"))return i}}function getPositionBreadcrumbClicked(href){let breadcrumb=document.getElementsByClassName("breadcrumb");for(let j=0;j<breadcrumb.length;j++){let lis=breadcrumb[j].getElementsByTagName("li");for(let i=0;i<lis.length;i++){let as=lis[i].getElementsByTagName("a");if(as.length>0){if(as[0].href===href)return i}}}}function bindBackButtonInCheckout(){let backButtons=document.getElementsByClassName("step__footer__previous-link");for(let j=0;j<backButtons.length;j++){let hrefBackButton=backButtons[j].href;hrefBackButton.indexOf("/cart")>=0?bindDataToElement("interaccion","volver_carrito","volver",backButtons[j]):hrefBackButton.indexOf("contact_information")>=0?bindDataToElement("interaccion","volver_info_cliente","volver",backButtons[j]):hrefBackButton.indexOf("shipping_method")>=0&&bindDataToElement("interaccion","volver_forma_envio","volver",backButtons[j])}}function checkErrorsInCheckout(section){checkErrorsInCheckoutPayment("continuar_KO_tarjeta_pago"===section?idErrorsPayment:idErrorsCheckout,section)}function checkErrorsInCheckoutPayment(ids,section){ids.forEach(function(element){let inputError=document.getElementById("#"+element);null!==inputError&&inputError.length>0&&"visible"===inputError.style.display&&errorDataInForm(getGoogleConstantForInputID(element),section)})}function getGoogleConstantForInputID(inputID){switch(inputID){case"error-for-email":return"email_KO";case"error-for-last_name":return"apellidos_KO";case"error-for-address1":return"direccion_KO";case"error-for-city":return"ciudad_KO";case"error-for-province":return"provincia_KO";case"error-for-zip":return"codigo_postal_KO";case"error-for-phone":return"telefono_KO";case"error-for-number":return"numtarjeta_KO";case"error-for-name":return"nomtarjeta_KO";case"error-for-expiry":return"mm_aa_KO";case"error-for-verification_value":return"cvv_KO"}}function actionEvent(){if(hasClass(this,"gtm-product"))sendProductClick(this);else if(hasClass(this,"gtm-modify-cart-product"))cartModified();else if(hasClass(this,"gtm-add-to-cart-product"))if(this.dataset.productid)addToCartProduct(getElementWithDataValue("id",this.dataset.productid));else{let form=this;do{form=form.parentElement}while("FORM"===!form.tagName&&"HTML"===!form.tagName);if("FORM"===form.tagName){let inputs=form.document.getElementsByName("id[]"),elements=[];for(let j=0;j<inputs.length;j++){let id=inputs[j].value;elements.push(getElementWithDataValue("productid",id))}addToCartProduct(elements)}}else hasClass(this,"gtm-remove-from-cart")?removeFromCart(this):otherClicks(this)}function getElementWithDataValue(data_name,value){let datas=document.querySelectorAll("[data-"+data_name+"]");for(let j=0;j<datas.length;j++)if(getData(datas[j],data_name)===value)return datas[j]}function hasClass(element,clase){return element.classList.contains(clase)}function sendProductClick(productElem){let objectToPush={event:"productClick",ecommerce:{click:{actionField:{list:googleConfig.list},products:[readProduct(productElem)]}}};writeDebug("sendProductClick"),sendObject(objectToPush)}function cartModified(){let inputs=document.getElementsByName("updates[]");for(let j=0;j<inputs.length;j++){let input=inputs[j],elemProd=getElemProductWithIdLine(input.getAttribute("id")),quantity=parseInt(input.value),quantityPrev=elemProd.dataset.quantity;if(writeDebug("quantity("+quantity+") quantityPrev("+quantityPrev+")"),hasRemoveQuantity(quantityPrev,quantity)){removeFromCartQuantity(elemProd,quantityPrev-quantity)}else if(hasAddedQuantity(quantityPrev,quantity)){let diff=quantity-quantityPrev;elemProd.dataset.quantity=diff,addToCartProduct(elemLine)}elemProd.dataset.quantity=quantity}}function getElemProductWithIdLine(id){return getElementWithDataValue("productid",id.split("_")[1])}function hasRemoveQuantity(quantityPrev,quantity){return quantityPrev>quantity}function hasAddedQuantity(quantityPrev,quantity){return quantityPrev<quantity}function addToCartProduct(product){let products=!1;if(products=readProducts(product||document.getElementsByClassName("gtm-product-info"))){for(let j=0;j<products.length;j++)delete products[j].list;let objectToPush={event:"addToCart",ecommerce:{currencyCode:googleConfig.currency_code,add:{products:products}}};writeDebug("addToCartProduct"),sendObject(objectToPush)}}function removeFromCart(elem){removeFromButtonDelete(elem)}function removeFromButtonDelete(elemButton){if(elemButton.dataset.productid){let productDelete=getElementWithDataValue("id",elemButton.dataset.productid);removeFromCartQuantity(productDelete,productDelete.dataset.quantity)}}function removeFromCartQuantity(elem,quantity){if(elem.dataset.productid){let product=readProduct(elem);product.quantity=quantity;let objectToPush={event:"removeFromCart",ecommerce:{remove:{products:[product]}}};writeDebug("removeFromCart"),sendObject(objectToPush)}}function otherClicks(elem){let event=getData(elem,"gtm-event"),action=getData(elem,"gtm-action"),label=getData(elem,"gtm-label");if(void 0!==event){let objectToPush=getStandardObject(event,action,label);"transaccion"===event&&elem.dataset.paymentMethod&&(objectToPush.paymentMethod=elem.dataset.paymentMethod),writeDebug("actionEvent"),sendObject(objectToPush)}}function getFreeShipping(gtm_shipping_price){return"0"===gtm_shipping_price?"SI":"NO"}function getInitialCoupon(){let discount=new URL(document.location.href).searchParams.get("code");return null!==discount?discount:"none"}function getUserID(){return"undefined"}function getClientID(){let gaCookie=read_cookie("_ga");if(null!=gaCookie){let lastPoint=gaCookie.lastIndexOf("."),firstPart=gaCookie.substr(0,lastPoint),lastPointInFirstPart=firstPart.lastIndexOf(".");return firstPart.substr(lastPointInFirstPart+1,firstPart.length)+gaCookie.substr(lastPoint,firstPart.length)}return"undefined"}function read_cookie(key){let result;return(result=new RegExp("(?:^|; )"+encodeURIComponent(key)+"=([^;]*)").exec(document.cookie))?result[1]:null}function getUserType(){return null==read_cookie("shopify_visited")?(document.cookie="shopify_visited=1","New User"):"Returning User"}function getDeviceFromWindow(){return screen.width<640?"mobile":screen.width>=640&&screen<=1024?"tablet":"desktop"}function isScrolledIntoView(elem){return"visible"!==!elem.style.display&&checkvisible(elem)}function checkvisible(elm){let scrollTop=scrollY(),posYElem=posY(elm);return posYElem>scrollTop&&posYElem<viewPortHeight()+scrollTop}function viewPortHeight(){var de=document.documentElement;return window.innerWidth?window.innerHeight:de&&!isNaN(de.clientHeight)?de.clientHeight:0}function scrollY(){return window.pageYOffset?window.pageYOffset:Math.max(document.documentElement.scrollTop,document.body.scrollTop)}function posY(elm){for(var test=elm,top=0;test&&"body"!==test.tagName.toLowerCase();)top+=test.offsetTop,test=test.offsetParent;return top}function detectFirstRowCategory(){if("product"!==gtm_template){let first_in_collections=document.getElementsByClassName("gtm-first-in-collection");for(let j=0;j<first_in_collections.length;j++){let e=first_in_collections[j],categorypos=e.dataset.categorypos;isScrolledIntoView(e)?scrolledCategories[categorypos]||(scrolledCategories[categorypos]=!0,sendEvent("scroll",e.dataset.category,categorypos)):SEND_SCROLLED_ONLY_FIRST_TIME||(scrolledCategories[categorypos]=!1)}}}function readProduct(e){1===e.length&&(e=e[0]);let keyPrice="price_"+googleConfig.currency_code,keyOriginalPrice="originalPrice_"+googleConfig.currency_code,keyProductDiscount="productDiscount_"+googleConfig.currency_code,product={name:e.dataset.name,id:e.dataset.id,price:e.dataset.price,brand:e.dataset.brand,category:e.dataset.category,model:e.dataset.model,dimension15:e.dataset.model,paste:e.dataset.paste,dimension14:e.dataset.paste,color:e.dataset.color,dimension16:e.dataset.color,tag:e.dataset.tag,dimension17:e.dataset.tag,[keyPrice]:e.dataset.price,metric2:e.dataset.price,[keyOriginalPrice]:e.dataset.originalprice,metric3:e.dataset.originalprice,[keyProductDiscount]:e.dataset.productdiscount,metric4:e.dataset.productdiscount};"EUR"!==googleConfig.currency_code&&(product.price_EUR=convertToEur(e.dataset.price,googleConfig.currency_code),product.originalPrice_EUR=convertToEur(e.dataset.originalprice,googleConfig.currency_code),product.productDiscount_EUR=convertToEur(e.dataset.productdiscount,googleConfig.currency_code),product.metric2=convertToEur(product.metric2,googleConfig.currency_code),product.metric3=convertToEur(product.metric3,googleConfig.currency_code),product.metric4=convertToEur(product.metric4,googleConfig.currency_code)),googleConfig.list&&(product.list=googleConfig.list),e.dataset.position&&(product.position=e.dataset.position);let freeProduct=e.dataset.freeproduct;return void 0!==freeProduct?product.freeProduct=freeProduct:0===product.price?product.freeProduct="SI":product.freeProduct="NO",product}function sendLastProductScrolled(products){if(products.length>0){let objectToPush={event:"impressionsLoad",ecommerce:{currencyCode:googleConfig.currency_code,impressions:products}};writeDebug("sendLastProductScrolled"),sendObject(objectToPush)}}function getProductsImpressions(){let products=document.getElementsByClassName("gtm-product");for(let j=0;j<products.length;j++){let e=products[j],position=e.dataset.id;void 0===position&&writeDebug("Los productos necesitan tener el sku en data-id"),isScrolledIntoView(e)?scrolledProducts[position]||(scrolledProducts[position]=!0,lastProductScrolled.push(readProduct(e))):SEND_SCROLLED_ONLY_FIRST_TIME||(scrolledProducts[position]=!1)}lastProductScrolled.length>0&&(sendLastProductScrolled(lastProductScrolled),lastProductScrolled=[])}function sendProductRender(){if(IS_GTM_ACTIVE&&GTM_PHASE_2){let productElem=document.getElementsByClassName("gtm-product-load");if(productElem.length){let objectToPush={event:"productDetailLoad",ecommerce:{detail:{products:[readProduct(productElem)]}}};delete objectToPush.ecommerce.detail.products[0].list,writeDebug("sendProductRender"),sendObject(objectToPush)}}}function checkout(step){if(GTM_PHASE_2){if(step===STEP_CARRITO){let inputs=document.getElementsByName("updates[]");for(let j=0;j<inputs.length;j++){let elem=inputs[j];products[elem.getAttribute("id")]=elem.value}}let objectToPush={event:"checkout",ecommerce:{checkout:{actionField:{step:step},products:readProducts(document.getElementsByClassName("gtm-product-info"))}}};writeDebug("checkout"),sendObject(objectToPush)}}function readProducts(elems){let products=[];for(let j=0;j<elems.length;j++){let e=elems[j],product=readProduct(e);product.quantity=e.dataset.quantity,products.push(product)}return products}function cuponInvalid(cuponString){sendEvent("formulario","cupon_KO",cuponString)}function errorDataInForm(field,section){sendEvent("formulario",field,section)}function saveCustomerInformation(){let customerInfoItem=localStorage.getItem("customerInfo"),lastCustomerInfo=void 0;null!=customerInfoItem&&(lastCustomerInfo=JSON.parse(customerInfoItem));let newCustomerInfo={email:document.getElementsByName("checkout[email]")[0].value,firstName:getValFromInputIfVisible(document.getElementsByName("checkout[shipping_address][first_name]")[0]),lastname:getValFromInputIfVisible(document.getElementsByName("checkout[shipping_address][last_name]")[0]),address:getValFromInputIfVisible(document.getElementsByName("checkout[shipping_address][address1]")[0]),city:getValFromInputIfVisible(document.getElementsByName("checkout[shipping_address][city]")[0]),country:document.getElementsByName("checkout[shipping_address][country]")[0].value,province:document.getElementsByName("checkout[shipping_address][province]").value,postalCode:getValFromInputIfVisible(document.getElementsByName("checkout[shipping_address][zip]")[0])};void 0===lastCustomerInfo||lastCustomerInfo.email!==newCustomerInfo.email||lastCustomerInfo.firstName!==newCustomerInfo.firstName||lastCustomerInfo.lastname!==newCustomerInfo.lastname||lastCustomerInfo.address!==newCustomerInfo.address||lastCustomerInfo.city!==newCustomerInfo.city||lastCustomerInfo.country!==newCustomerInfo.country||lastCustomerInfo.province!==newCustomerInfo.province||lastCustomerInfo.postalCode!==newCustomerInfo.postalCode?newCustomerInfo.correct=!1:newCustomerInfo.correct=lastCustomerInfo.correct,localStorage.setItem("customerInfo",JSON.stringify(newCustomerInfo))}function getValFromInputIfVisible(input){if(!input.classList.contains("visually-hidden"))return input.value}function customerStepOK(){let customerInfo=JSON.parse(localStorage.getItem("customerInfo"));null===customerInfo?sendEvent("formulario","continuar_OK","continuar_OK_datos_usuario"):customerInfo.correct||(sendEvent("formulario","continuar_OK","continuar_OK_datos_usuario"),customerInfo.correct=!0,localStorage.setItem("customerInfo",JSON.stringify(customerInfo)))}function bindDataToElement(event,action,label,element){setData(element,"gtm-event",event),setData(element,"gtm-action",action),setData(element,"gtm-label",label),element.addEventListener("click",actionEvent)}function OKPago(){sendEvent("formulario","continuar_OK","continuar_OK_pago")}function thanksPage(){let idOrder=document.getElementsByClassName("os-order-number")[0].innerHTML.split("#")[1].trim(),revenue=Shopify.checkout.total_price,shipping=0;void 0!==Shopify.checkout.shipping_rate&&void 0!==Shopify.checkout.shipping_rate.price&&(shipping=Shopify.checkout.shipping_rate.price);let objectToPush={ecommerce:{purchase:{actionField:{id:idOrder,revenue:revenue,shipping:shipping,coupon:googleConfig.coupon},products:readProducts(document.getElementsByClassName("gtm-product-info"))}}};ACCEPTED_GDPR||delete objectToPush.ecommerce.purchase.actionField.id,writeDebug("thanksPage"),sendObject(objectToPush)}function bindBtnContinuePaymentMethod(){let btnContinue=document.getElementsByClassName("step__footer__continue-btn");for(let j=0;j<btnContinue.length;j++)btnContinue[j].addEventListener("click",function(){let inputs=document.getElementsByName("checkout[payment_gateway]"),paymentMethod=null;for(let i=0;i<inputs.length;i++){let input=inputs[i];input.checked&&(paymentMethod=input)}if(null===paymentMethod){inputs=document.getElementsByName("checkout[payment_gateway]");for(let i=0;i<inputs.length;i++){let input=inputs[i];input.enabled&&(paymentMethod=input)}}null!==paymentMethod&&sendPaymentMethod(paymentMethod)})}function sendPaymentMethod(paymentMethod){let paymentMethodValue=paymentMethod.value;if(void 0!==paymentMethods[paymentMethodValue]){let paymentMethodValueToGoogle=paymentMethods[paymentMethodValue];sendEvent("transaccion","pagar_"+paymentMethodValueToGoogle,paymentMethodValueToGoogle)}else writeDebug("No se sabe el metodo de pago seleccionado")}function sendCountryUser(){getJSONP("http://freegeoip.net/json/?callback=?",responseCountryUser)}function responseCountryUser(data){let country=data.country_name;writeDebug("sendCountryUser"),sendObject({event:"country",country:country.toLowerCase()})}function bindSocialButtons(){let as=document.getElementsByTagName("a");for(let j=0;j<as.length;j++){let a=as[j],href=a.href;if(void 0!==href){let gtm_action="";href.indexOf("facebook.com")>=0?gtm_action="facebook":href.indexOf("twitter.com")>=0?gtm_action="twitter":href.indexOf("instagram.com")>=0&&(gtm_action="instagram"),""!==gtm_action&&(hasClass(a,"gtm-action")||a.classList.add("gtm-action"),addDataIfNotExists(a,"gtm-event","redes_sociales"),addDataIfNotExists(a,"gtm-action",gtm_action),addDataIfNotExists(a,"gtm-label","seguir"))}}}function addDataIfNotExists(elem,nameData,value){void 0===getData(elem,nameData)&&setData(elem,nameData,value)}function convertToEur(value,currencyCode){return"undefined"!=typeof gtm_currencies?Math.round(parseFloat(value)/gtm_currencies[currencyCode]*100)/100:"undefined"}function getData(elem,dataName){return elem.getAttribute("data-"+dataName)}function setData(elem,dataName,value){elem.setAttribute("data-"+dataName,value)}document.addEventListener("DOMContentLoaded",function(event){IS_GTM_ACTIVE&&GTM_PHASE_2&&(DATALAYER?processGTM():tryProcessGTM())});